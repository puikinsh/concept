<!doctype html>
<html lang="en">
<head>
    {{> layouts/head pageTitle="Inbox" }}
</head>
<body>
    <div class="dashboard-main-wrapper">
        {{> layouts/header }}
        {{> layouts/sidebar currentPage="inbox" }}
        
        <div class="dashboard-wrapper">
            <div class="container-fluid dashboard-content">
                <!-- Page Header -->
                <div class="row">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                        <div class="page-header">
                            <h2 class="pageheader-title">Inbox</h2>
                            <p class="pageheader-text">Manage your emails efficiently</p>
                            <div class="page-breadcrumb">
                                <nav aria-label="breadcrumb">
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item"><a href="/" class="breadcrumb-link">Dashboard</a></li>
                                        <li class="breadcrumb-item"><a href="#" class="breadcrumb-link">Apps</a></li>
                                        <li class="breadcrumb-item active" aria-current="page">Inbox</li>
                                    </ol>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Email Interface -->
                <div class="row">
                    <div class="col-xl-12">
                        <div class="card">
                            <div class="card-body p-0">
                                <div class="email-wrapper">
                                    <div class="row g-0">
                                        <!-- Sidebar -->
                                        <div class="col-lg-3 col-md-4 border-end">
                                            <div class="email-sidebar p-4">
                                                <!-- Compose Button -->
                                                <button class="btn btn-primary btn-lg w-100 mb-4" data-bs-toggle="modal" data-bs-target="#composeModal">
                                                    <i class="fas fa-edit me-2"></i>Compose
                                                </button>

                                                <!-- Folders -->
                                                <div class="email-folders">
                                                    <h6 class="text-muted text-uppercase small mb-3">Folders</h6>
                                                    <div class="list-group list-group-flush">
                                                        <a href="#" class="list-group-item list-group-item-action active border-0 rounded mb-1" data-folder="inbox">
                                                            <i class="fas fa-inbox me-3"></i>
                                                            <span>Inbox</span>
                                                            <span class="badge bg-primary rounded-pill float-end">12</span>
                                                        </a>
                                                        <a href="#" class="list-group-item list-group-item-action border-0 rounded mb-1" data-folder="sent">
                                                            <i class="fas fa-paper-plane me-3"></i>
                                                            <span>Sent</span>
                                                        </a>
                                                        <a href="#" class="list-group-item list-group-item-action border-0 rounded mb-1" data-folder="drafts">
                                                            <i class="fas fa-file-alt me-3"></i>
                                                            <span>Drafts</span>
                                                            <span class="badge bg-secondary rounded-pill float-end">3</span>
                                                        </a>
                                                        <a href="#" class="list-group-item list-group-item-action border-0 rounded mb-1" data-folder="starred">
                                                            <i class="fas fa-star me-3"></i>
                                                            <span>Starred</span>
                                                        </a>
                                                        <a href="#" class="list-group-item list-group-item-action border-0 rounded mb-1" data-folder="trash">
                                                            <i class="fas fa-trash me-3"></i>
                                                            <span>Trash</span>
                                                        </a>
                                                    </div>
                                                </div>

                                                <!-- Labels -->
                                                <div class="email-labels mt-4">
                                                    <h6 class="text-muted text-uppercase small mb-3">Labels</h6>
                                                    <div class="d-flex flex-column gap-2">
                                                        <a href="#" class="text-decoration-none text-dark">
                                                            <span class="badge bg-danger me-2">&nbsp;</span>Important
                                                        </a>
                                                        <a href="#" class="text-decoration-none text-dark">
                                                            <span class="badge bg-success me-2">&nbsp;</span>Business
                                                        </a>
                                                        <a href="#" class="text-decoration-none text-dark">
                                                            <span class="badge bg-warning me-2">&nbsp;</span>Personal
                                                        </a>
                                                        <a href="#" class="text-decoration-none text-dark">
                                                            <span class="badge bg-info me-2">&nbsp;</span>Work
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Email List -->
                                        <div class="col-lg-9 col-md-8" id="emailListContainer">
                                            <!-- Email Toolbar -->
                                            <div class="email-toolbar border-bottom p-3">
                                                <div class="row align-items-center">
                                                    <div class="col-md-6">
                                                        <div class="d-flex align-items-center gap-3">
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox" id="selectAll">
                                                            </div>
                                                            <div class="btn-group" role="group">
                                                                <button type="button" class="btn btn-sm btn-outline-secondary">
                                                                    <i class="fas fa-trash"></i>
                                                                </button>
                                                                <button type="button" class="btn btn-sm btn-outline-secondary">
                                                                    <i class="fas fa-exclamation-circle"></i>
                                                                </button>
                                                                <button type="button" class="btn btn-sm btn-outline-secondary">
                                                                    <i class="fas fa-folder"></i>
                                                                </button>
                                                                <button type="button" class="btn btn-sm btn-outline-secondary">
                                                                    <i class="fas fa-tag"></i>
                                                                </button>
                                                            </div>
                                                            <button type="button" class="btn btn-sm btn-outline-secondary">
                                                                <i class="fas fa-sync"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group">
                                                            <input type="text" class="form-control form-control-sm" placeholder="Search emails...">
                                                            <button class="btn btn-outline-secondary btn-sm" type="button">
                                                                <i class="fas fa-search"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Email List Items -->
                                            <div class="email-list" id="emailList">
                                                <!-- Emails will be loaded dynamically -->
                                            </div>
                                            
                                            <!-- Email View -->
                                            <div class="email-view d-none" id="emailView">
                                                <div class="email-view-header border-bottom p-3">
                                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                                        <button class="btn btn-outline-secondary btn-sm" id="backToList">
                                                            <i class="fas fa-arrow-left me-2"></i>Back to inbox
                                                        </button>
                                                        <div class="btn-group" role="group">
                                                            <button type="button" class="btn btn-sm btn-outline-secondary">
                                                                <i class="fas fa-reply"></i>
                                                            </button>
                                                            <button type="button" class="btn btn-sm btn-outline-secondary">
                                                                <i class="fas fa-reply-all"></i>
                                                            </button>
                                                            <button type="button" class="btn btn-sm btn-outline-secondary">
                                                                <i class="fas fa-share"></i>
                                                            </button>
                                                            <button type="button" class="btn btn-sm btn-outline-secondary">
                                                                <i class="fas fa-trash"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <h4 class="email-subject mb-3"></h4>
                                                    <div class="d-flex align-items-center">
                                                        <div class="avatar avatar-sm me-3">
                                                            <span class="avatar-initial rounded-circle bg-primary"></span>
                                                        </div>
                                                        <div class="flex-grow-1">
                                                            <h6 class="mb-0 email-from"></h6>
                                                            <small class="text-muted">to me</small>
                                                        </div>
                                                        <div>
                                                            <small class="text-muted email-date"></small>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="email-view-body p-4">
                                                    <div class="email-content">
                                                        <!-- Email content will be loaded here -->
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Pagination -->
                                            <div class="email-pagination p-3 border-top">
                                                <div class="row align-items-center">
                                                    <div class="col">
                                                        <p class="mb-0 text-muted">Showing 1-5 of 125 emails</p>
                                                    </div>
                                                    <div class="col-auto">
                                                        <nav aria-label="Email pagination">
                                                            <ul class="pagination pagination-sm mb-0">
                                                                <li class="page-item disabled">
                                                                    <a class="page-link" href="#" tabindex="-1">Previous</a>
                                                                </li>
                                                                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                                                <li class="page-item"><a class="page-link" href="#">2</a></li>
                                                                <li class="page-item"><a class="page-link" href="#">3</a></li>
                                                                <li class="page-item">
                                                                    <a class="page-link" href="#">Next</a>
                                                                </li>
                                                            </ul>
                                                        </nav>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {{> layouts/footer }}
        </div>
    </div>

    <!-- Compose Modal -->
    <div class="modal fade" id="composeModal" tabindex="-1" aria-labelledby="composeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="composeModalLabel">New Message</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <input type="email" class="form-control" placeholder="To:">
                        </div>
                        <div class="mb-3">
                            <input type="text" class="form-control" placeholder="Subject:">
                        </div>
                        <div class="mb-3">
                            <textarea class="form-control" rows="10" placeholder="Write your message here..."></textarea>
                        </div>
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-light btn-sm">
                                <i class="fas fa-paperclip"></i> Attach
                            </button>
                            <button type="button" class="btn btn-light btn-sm">
                                <i class="fas fa-image"></i> Insert Photo
                            </button>
                            <button type="button" class="btn btn-light btn-sm">
                                <i class="fas fa-link"></i> Insert Link
                            </button>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Discard</button>
                    <button type="button" class="btn btn-light">Save Draft</button>
                    <button type="button" class="btn btn-primary">Send</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import '../scss/main.scss';
        import '../js/app.js';
        
        document.addEventListener('DOMContentLoaded', () => {
            // Email data for different folders
            const emailData = {
                inbox: [
                    {
                        id: 1,
                        from: 'John Doe',
                        initials: 'JD',
                        color: 'primary',
                        subject: 'Project Update - Q4 Results',
                        preview: 'Hi team, I wanted to share the latest quarterly results with everyone. The numbers are looking great...',
                        time: '10:30 AM',
                        label: { text: 'Important', class: 'danger' },
                        starred: false,
                        read: false,
                        content: `
                            <p>Hi team,</p>
                            <p>I wanted to share the latest quarterly results with everyone. The numbers are looking great, and I'm excited to discuss our strategy for Q1.</p>
                            <p>Key highlights:</p>
                            <ul>
                                <li>Revenue up 23% compared to Q3</li>
                                <li>Customer satisfaction at an all-time high (4.8/5)</li>
                                <li>Successfully launched 3 new features</li>
                                <li>Team expanded by 15 new members</li>
                            </ul>
                            <p>I've attached the full report for your review. Please take a look before our meeting on Friday.</p>
                            <p>Best regards,<br>John</p>
                        `
                    },
                    {
                        id: 2,
                        from: 'Sarah Anderson',
                        initials: 'SA',
                        color: 'success',
                        subject: 'Meeting Tomorrow at 2 PM',
                        preview: "Don't forget about our meeting tomorrow. I've prepared the agenda and shared it in the team folder...",
                        time: '9:15 AM',
                        label: { text: 'Business', class: 'success' },
                        starred: true,
                        read: false,
                        content: `
                            <p>Hi there,</p>
                            <p>Just a quick reminder about our meeting tomorrow at 2 PM in the main conference room.</p>
                            <p>Agenda items:</p>
                            <ol>
                                <li>Review Q4 performance metrics</li>
                                <li>Discuss 2024 roadmap</li>
                                <li>Team resource allocation</li>
                                <li>Budget planning for next quarter</li>
                            </ol>
                            <p>I've shared the detailed agenda and supporting documents in our team folder. Please review them before the meeting.</p>
                            <p>See you tomorrow!<br>Sarah</p>
                        `
                    },
                    {
                        id: 3,
                        from: 'Mike Johnson',
                        initials: 'MJ',
                        color: 'warning',
                        subject: 'Re: Vacation Request',
                        preview: 'Your vacation request has been approved. Enjoy your time off and see you when you get back...',
                        time: 'Yesterday',
                        label: { text: 'Personal', class: 'warning' },
                        starred: false,
                        read: true,
                        content: `
                            <p>Hi,</p>
                            <p>Your vacation request for Dec 25 - Jan 2 has been approved. I've updated the team calendar and notified the relevant people.</p>
                            <p>Please make sure to:</p>
                            <ul>
                                <li>Complete your pending tasks or delegate them</li>
                                <li>Set up your out-of-office auto-reply</li>
                                <li>Share any important passwords or access with your backup</li>
                            </ul>
                            <p>Enjoy your time off and see you when you get back!</p>
                            <p>Best,<br>Mike</p>
                        `
                    },
                    {
                        id: 4,
                        from: 'Tech Company',
                        initials: 'TC',
                        color: 'info',
                        subject: 'New Feature Release - Version 2.5',
                        preview: "We're excited to announce the release of version 2.5 with many new features and improvements...",
                        time: 'Dec 28',
                        label: { text: 'Work', class: 'info' },
                        starred: false,
                        read: false,
                        content: `
                            <p>Dear valued customer,</p>
                            <p>We're thrilled to announce the release of Version 2.5 of our platform!</p>
                            <h5>What's New:</h5>
                            <ul>
                                <li><strong>Advanced Analytics Dashboard</strong> - Get deeper insights into your data</li>
                                <li><strong>API v3</strong> - Faster and more reliable</li>
                                <li><strong>Dark Mode</strong> - Easy on the eyes during those late nights</li>
                                <li><strong>Performance Improvements</strong> - 40% faster load times</li>
                            </ul>
                            <p>Check out our <a href="#">release notes</a> for a complete list of changes.</p>
                            <p>Thank you for being a loyal customer!</p>
                            <p>The Tech Company Team</p>
                        `
                    },
                    {
                        id: 5,
                        from: 'Emily Martinez',
                        initials: 'EM',
                        color: 'secondary',
                        subject: 'Design Review Feedback',
                        preview: "I've reviewed the latest designs and they look fantastic! Just a few minor suggestions...",
                        time: 'Dec 27',
                        label: { text: 'Business', class: 'success' },
                        starred: false,
                        read: false,
                        content: `
                            <p>Hi team,</p>
                            <p>I've completed my review of the latest design mockups. Overall, they look fantastic! The new color scheme really brings everything together.</p>
                            <p>A few suggestions for consideration:</p>
                            <ul>
                                <li>The navigation menu could use a bit more padding on mobile</li>
                                <li>Consider adding hover states to the card components</li>
                                <li>The contrast on the secondary buttons might need adjustment for accessibility</li>
                            </ul>
                            <p>I've added detailed comments in Figma. Let me know if you'd like to discuss any of these points.</p>
                            <p>Great work!<br>Emily</p>
                        `
                    }
                ],
                sent: [
                    {
                        id: 6,
                        from: 'You',
                        to: 'Team',
                        initials: 'ME',
                        color: 'dark',
                        subject: 'Weekly Status Update',
                        preview: 'Here\'s our weekly status update. We made great progress on all fronts this week...',
                        time: '2 hours ago',
                        label: { text: 'Business', class: 'success' },
                        starred: false,
                        read: true,
                        content: `
                            <p>Team,</p>
                            <p>Here's our weekly status update for the week of Dec 25-29.</p>
                            <h5>Completed:</h5>
                            <ul>
                                <li>Finished user authentication module</li>
                                <li>Deployed hotfix for payment processing</li>
                                <li>Completed 5 customer interviews</li>
                            </ul>
                            <h5>In Progress:</h5>
                            <ul>
                                <li>Dashboard redesign (70% complete)</li>
                                <li>API documentation update</li>
                                <li>Performance optimization</li>
                            </ul>
                            <p>Let me know if you have any questions.</p>
                            <p>Best regards</p>
                        `
                    },
                    {
                        id: 7,
                        from: 'You',
                        to: 'Client ABC',
                        initials: 'ME',
                        color: 'dark',
                        subject: 'Project Proposal - Mobile App',
                        preview: 'Please find attached our proposal for the mobile app development project...',
                        time: 'Yesterday',
                        label: { text: 'Important', class: 'danger' },
                        starred: true,
                        read: true,
                        content: `
                            <p>Dear Client,</p>
                            <p>Thank you for considering us for your mobile app development project.</p>
                            <p>Please find attached our detailed proposal which includes:</p>
                            <ul>
                                <li>Project scope and deliverables</li>
                                <li>Timeline and milestones</li>
                                <li>Budget breakdown</li>
                                <li>Team composition</li>
                                <li>Our previous work samples</li>
                            </ul>
                            <p>We're confident that our team can deliver a high-quality solution that meets your requirements.</p>
                            <p>Looking forward to your feedback.</p>
                            <p>Best regards</p>
                        `
                    }
                ],
                drafts: [
                    {
                        id: 8,
                        from: 'You',
                        to: '',
                        initials: 'ME',
                        color: 'dark',
                        subject: 'Budget Review Meeting Notes',
                        preview: 'Draft: Need to finish the meeting notes from yesterday\'s budget review...',
                        time: '1 hour ago',
                        label: { text: 'Draft', class: 'secondary' },
                        starred: false,
                        read: true,
                        content: `
                            <p>[DRAFT - IN PROGRESS]</p>
                            <p>Meeting Notes - Budget Review</p>
                            <p>Date: Dec 29, 2023</p>
                            <p>Attendees: [TODO: Add attendee list]</p>
                            <h5>Key Points Discussed:</h5>
                            <ul>
                                <li>Q4 spending review</li>
                                <li>2024 budget allocation</li>
                                <li>[TODO: Add more points]</li>
                            </ul>
                            <p>[Need to add action items and next steps]</p>
                        `
                    },
                    {
                        id: 9,
                        from: 'You',
                        to: 'Marketing Team',
                        initials: 'ME',
                        color: 'dark',
                        subject: 'Campaign Ideas for Q1',
                        preview: 'Draft: Brainstorming some campaign ideas for next quarter...',
                        time: '3 days ago',
                        label: { text: 'Draft', class: 'secondary' },
                        starred: false,
                        read: true,
                        content: `
                            <p>[DRAFT]</p>
                            <p>Team,</p>
                            <p>I've been brainstorming some campaign ideas for Q1:</p>
                            <ul>
                                <li>Social media contest - "New Year, New You"</li>
                                <li>Email series on productivity tips</li>
                                <li>Partnership with influencers</li>
                                <li>[Need to add more ideas]</li>
                            </ul>
                            <p>[TODO: Add budget estimates and timeline]</p>
                        `
                    }
                ],
                starred: [],
                trash: [
                    {
                        id: 10,
                        from: 'Newsletter',
                        initials: 'NL',
                        color: 'secondary',
                        subject: 'Special Offer - 50% Off',
                        preview: 'Limited time offer! Get 50% off on all premium plans...',
                        time: '1 week ago',
                        label: { text: 'Spam', class: 'dark' },
                        starred: false,
                        read: true,
                        content: `<p>This email has been moved to trash.</p>`
                    }
                ]
            };
            
            let currentFolder = 'inbox';
            let currentEmail = null;
            
            // Initialize starred emails
            emailData.starred = [...emailData.inbox, ...emailData.sent, ...emailData.drafts].filter(email => email.starred);
            
            // Render email list
            function renderEmailList(folder) {
                const emailList = document.getElementById('emailList');
                const emails = emailData[folder] || [];
                
                emailList.innerHTML = emails.map(email => `
                    <div class="email-item border-bottom p-3 hover-bg-light ${email.read ? 'bg-light' : ''}" data-email-id="${email.id}">
                        <div class="row align-items-center">
                            <div class="col-auto">
                                <div class="form-check">
                                    <input class="form-check-input email-checkbox" type="checkbox">
                                </div>
                            </div>
                            <div class="col-auto">
                                <i class="${email.starred ? 'fas' : 'far'} fa-star ${email.starred ? 'text-warning' : 'text-muted hover-text-warning'}"></i>
                            </div>
                            <div class="col">
                                <div class="d-flex align-items-center">
                                    <div class="avatar avatar-sm me-3">
                                        <span class="avatar-initial rounded-circle bg-${email.color}">${email.initials}</span>
                                    </div>
                                    <div class="flex-grow-1 min-width-0">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div class="text-truncate">
                                                <h6 class="mb-0 ${email.read ? 'fw-normal' : 'fw-semibold'}">${email.from}${email.to ? ' → ' + email.to : ''}</h6>
                                                <p class="mb-0 ${email.read ? 'text-muted' : 'text-dark'}">${email.subject}</p>
                                                <p class="mb-0 text-muted small text-truncate">${email.preview}</p>
                                            </div>
                                            <div class="text-end ms-3 flex-shrink-0">
                                                <small class="text-muted">${email.time}</small>
                                                ${email.label ? `<div><span class="badge bg-${email.label.class}">${email.label.text}</span></div>` : ''}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                // Update pagination text
                document.querySelector('.email-pagination p').textContent = `Showing 1-${emails.length} of ${emails.length} emails`;
                
                // Re-attach event listeners
                attachEmailListeners();
            }
            
            // Show email view
            function showEmail(emailId) {
                const email = [...emailData.inbox, ...emailData.sent, ...emailData.drafts, ...emailData.trash].find(e => e.id === emailId);
                if (!email) return;
                
                currentEmail = email;
                email.read = true;
                
                // Hide list, show view
                document.getElementById('emailList').classList.add('d-none');
                document.querySelector('.email-pagination').classList.add('d-none');
                document.getElementById('emailView').classList.remove('d-none');
                
                // Update view content
                document.querySelector('.email-subject').textContent = email.subject;
                document.querySelector('.email-from').textContent = email.from + (email.to ? ' → ' + email.to : '');
                document.querySelector('.email-date').textContent = email.time;
                document.querySelector('.email-view .avatar-initial').textContent = email.initials;
                document.querySelector('.email-view .avatar-initial').className = `avatar-initial rounded-circle bg-${email.color}`;
                document.querySelector('.email-content').innerHTML = email.content;
            }
            
            // Back to list
            document.getElementById('backToList').addEventListener('click', () => {
                document.getElementById('emailView').classList.add('d-none');
                document.getElementById('emailList').classList.remove('d-none');
                document.querySelector('.email-pagination').classList.remove('d-none');
                renderEmailList(currentFolder);
            });
            
            // Folder navigation
            document.querySelectorAll('[data-folder]').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Update active state
                    document.querySelectorAll('[data-folder]').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update current folder and render
                    currentFolder = this.dataset.folder;
                    renderEmailList(currentFolder);
                    
                    // Hide email view if showing
                    document.getElementById('emailView').classList.add('d-none');
                    document.getElementById('emailList').classList.remove('d-none');
                    document.querySelector('.email-pagination').classList.remove('d-none');
                });
            });
            
            // Attach email list event listeners
            function attachEmailListeners() {
                // Select all functionality
                const selectAll = document.getElementById('selectAll');
                const emailCheckboxes = document.querySelectorAll('.email-checkbox');
                
                selectAll.addEventListener('change', function() {
                    emailCheckboxes.forEach(checkbox => {
                        checkbox.checked = this.checked;
                    });
                });
                
                // Email item click handler
                document.querySelectorAll('.email-item').forEach(item => {
                    item.addEventListener('click', function(e) {
                        // Don't trigger if clicking on checkbox or star
                        if (e.target.type === 'checkbox' || e.target.classList.contains('fa-star') || e.target.classList.contains('far')) {
                            return;
                        }
                        
                        const emailId = parseInt(this.dataset.emailId);
                        showEmail(emailId);
                    });
                });
                
                // Star toggle
                document.querySelectorAll('.fa-star, .far.fa-star').forEach(star => {
                    star.addEventListener('click', function(e) {
                        e.stopPropagation();
                        
                        const emailItem = this.closest('.email-item');
                        const emailId = parseInt(emailItem.dataset.emailId);
                        const email = [...emailData.inbox, ...emailData.sent, ...emailData.drafts].find(e => e.id === emailId);
                        
                        if (email) {
                            email.starred = !email.starred;
                            if (this.classList.contains('far')) {
                                this.classList.remove('far', 'text-muted');
                                this.classList.add('fas', 'text-warning');
                            } else {
                                this.classList.remove('fas', 'text-warning');
                                this.classList.add('far', 'text-muted');
                            }
                            
                            // Update starred folder
                            emailData.starred = [...emailData.inbox, ...emailData.sent, ...emailData.drafts].filter(email => email.starred);
                        }
                    });
                });
            }
            
            // Initial render
            renderEmailList('inbox');
        });
    </script>

    <style>
        .email-wrapper {
            min-height: 600px;
        }
        
        .email-sidebar {
            min-height: 600px;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .avatar-initial {
            font-size: 0.875rem;
            font-weight: 600;
            color: white;
        }
        
        .hover-bg-light:hover {
            background-color: #f8f9fa !important;
            cursor: pointer;
        }
        
        .hover-text-warning:hover {
            color: #ffc107 !important;
            cursor: pointer;
        }
        
        .min-width-0 {
            min-width: 0;
        }
        
        .email-item {
            transition: background-color 0.15s ease-in-out;
        }
        
        .email-checkbox {
            cursor: pointer;
        }
        
        .list-group-item-action:hover {
            background-color: #f8f9fa;
        }
        
        .list-group-item-action.active {
            background-color: #e9ecef;
            color: #212529;
            border-color: transparent;
        }
    </style>
</body>
</html>